# Import required libraries
import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import LabelEncoder, StandardScaler
from sklearn.linear_model import LinearRegression
from sklearn.metrics import r2_score, mean_absolute_error

# Load the dataset
# Replace with your dataset file path, e.g. "car_data.csv"
data = pd.read_csv("/archive (7).zip")

# Display first few rows
print("üìÑ Sample Data:")
print(data.head())

# Check for missing values
print("\n‚ùì Missing Values:")
print(data.isnull().sum())

# Example columns expected:
# ['Car_Name', 'Year', 'Selling_Price', 'Present_Price', 'Driven_kms',
#  'Fuel_Type', 'Seller_Type', 'Transmission', 'Owner']

# Encode categorical columns
label_enc = LabelEncoder()
for col in ['Fuel_Type', 'Selling_type', 'Transmission']:
    if col in data.columns:
        data[col] = label_enc.fit_transform(data[col])

# Define features (X) and target (y)
X = data.drop(['Car_Name', 'Selling_Price'], axis=1)
y = data['Selling_Price']

# Split into train & test
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# Feature scaling
scaler = StandardScaler()
X_train = scaler.fit_transform(X_train)
X_test = scaler.transform(X_test)

# Train a Linear Regression model
model = LinearRegression()
model.fit(X_train, y_train)

# Make predictions
y_pred = model.predict(X_test)

# Evaluate performance
r2 = r2_score(y_test, y_pred)
mae = mean_absolute_error(y_test, y_pred)

print("\n‚úÖ Model Evaluation Results:")
print(f"R¬≤ Score: {r2 * 100:.2f}%")
print(f"Mean Absolute Error: {mae:.2f}")

# Predict price for a custom input
# Example format: [Year, Present_Price, Driven_kms, Fuel_Type, Seller_Type, Transmission, Owner]
sample = [[2019, 5.59, 27000, 0, 1, 1, 0]]
sample_scaled = scaler.transform(sample)
predicted_price = model.predict(sample_scaled)
print(f"\nüöó Predicted Car Price for Sample Input: ‚Çπ{predicted_price[0]:.2f} lakhs")
